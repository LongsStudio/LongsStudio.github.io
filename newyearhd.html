<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êñ∞Âπ¥Á∫¢ÂåÖÊäΩÂ•ñ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .header {
            margin-bottom: 20px;
        }
        
        .title {
            font-size: 2rem;
            color: #FFD700;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 20px;
            color: white;
        }
        
        .blocks-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 15px;
            width: 100%;
            max-width: 350px;
            margin: 0 auto 30px;
        }
        
        .block {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            cursor: pointer;
        }
        
        .block.active {
            background: linear-gradient(135deg, #FFD700 0%, #FF9800 100%);
            transform: scale(1.05);
            border-color: #FFD700;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.7);
        }
        
        .block-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 5px;
        }
        
        .block.active .block-value {
            color: #d32f2f;
        }
        
        .block-name {
            font-size: 0.9rem;
            color: white;
        }
        
        .block.active .block-name {
            color: #333;
            font-weight: bold;
        }
        
        .controls {
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(to bottom, #4CAF50, #388E3C);
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            min-width: 150px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .btn:disabled {
            background: linear-gradient(to bottom, #666, #444);
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .balance {
            font-size: 1.3rem;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            color: white;
        }
        
        .balance-amount {
            font-weight: bold;
            color: #FFD700;
        }
        
        .status {
            font-size: 1rem;
            margin: 10px 0;
            padding: 8px 15px;
            border-radius: 15px;
            display: inline-block;
        }
        
        .status.available {
            background: rgba(76, 175, 80, 0.2);
            color: #C8E6C9;
        }
        
        .status.unavailable {
            background: rgba(244, 67, 54, 0.2);
            color: #FFCDD2;
        }
        
        .result-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .result-content {
            background: linear-gradient(135deg, #ffd700 0%, #ff9800 100%);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            width: 100%;
            max-width: 350px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            border: 3px solid #fff;
            position: relative;
            animation: modalAppear 0.3s ease-out;
        }
        
        @keyframes modalAppear {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .result-title {
            font-size: 1.8rem;
            color: #c62828;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .result-amount {
            font-size: 2.5rem;
            font-weight: bold;
            color: #c62828;
            margin: 15px 0;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .result-message {
            font-size: 1.1rem;
            color: #333;
            margin: 15px 0;
            line-height: 1.5;
        }
        
        .qr-code {
            margin: 15px auto;
            padding: 10px;
            background: white;
            border-radius: 8px;
            display: inline-block;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        .qr-code img {
            width: 150px;
            height: 150px;
            display: block;
        }
        
        .qr-code-text {
            margin-top: 8px;
            font-size: 0.9rem;
            color: #333;
        }
        
        .close-modal {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #c62828;
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .title {
                font-size: 1.5rem;
            }
            
            .blocks-container {
                max-width: 300px;
                gap: 10px;
            }
            
            .block {
                padding: 15px;
            }
            
            .block-value {
                font-size: 1.2rem;
            }
            
            .block-name {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üßß Êñ∞Âπ¥Á∫¢ÂåÖÊäΩÂ•ñ üßß</h1>
            <p class="subtitle">ÊØèÂ§©‰∏ÄÊ¨°Êú∫‰ºöÔºåÁÇπÂáªÂºÄÂßãÊäΩÂ•ñÔºåËµ¢ÂèñÊñ∞Âπ¥Á∫¢ÂåÖÔºÅ</p>
        </div>
        
        <div class="blocks-container" id="blocksContainer">
            <!-- 6‰∏™ÊñπÂùóÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
        </div>
        
        <div class="status" id="statusMessage"></div>
        
        <div class="controls">
            <button class="btn" id="startButton">ÂºÄÂßãÊäΩÂ•ñ</button>
        </div>
        
        <div class="balance">
            Ââ©‰ΩôÂ•ñÈáë: <span id="balanceAmount" class="balance-amount">10.00</span> ÂÖÉ
        </div>
    </div>
    
    <div class="result-modal" id="resultModal">
        <div class="result-content">
            <button class="close-modal" id="closeModal">&times;</button>
            <h2 class="result-title" id="resultTitle">ÊÅ≠ÂñúÊÇ®ÔºÅ</h2>
            <div class="result-amount" id="resultAmount">1.00 ÂÖÉ</div>
            <p class="result-message" id="resultMessage">Êñ∞Âπ¥Âø´‰πêÔºÅÁ•ùÊÇ®Ë¥¢Ê∫êÂπøËøõÔºÅ</p>
            
            <div class="qr-code" id="qrCodeContainer">
                <div id="qrCodeImage"></div>
                <div class="qr-code-text" id="qrCodeText">Êâ´Á†ÅÈ¢ÜÂèñÁ∫¢ÂåÖ</div>
            </div>
            
            <button class="btn" id="playAgainBtn">Á°ÆÂÆö</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Â•ñÈ°πÈÖçÁΩÆ - Êñ∞Âπ¥Á•ùÁ¶èÊùÉÈáçÊúÄÈ´òÔºåÁé∞ÈáëÂ•ñÂä±ÊùÉÈáç‰Ωé
            const prizes = [
                { 
                    id: 1,
                    name: "1ÂÖÉÁ∫¢ÂåÖ", 
                    value: 1.00, 
                    weight: 1,  // ÊùÉÈáçÂæà‰Ωé
                    color: "#FFEB3B", 
                    message: "ÊÅ≠ÂñúËé∑Âæó1ÂÖÉÁ∫¢ÂåÖÔºÅÊñ∞Âπ¥ÂºÄÈó®Á∫¢ÔºÅ",
                    hasPrize: true
                },
                { 
                    id: 2,
                    name: "0.5ÂÖÉÁ∫¢ÂåÖ", 
                    value: 0.50, 
                    weight: 2,
                    color: "#4CAF50", 
                    message: "ÊÅ≠ÂñúËé∑Âæó0.5ÂÖÉÁ∫¢ÂåÖÔºÅÂ•ΩËøêËøûËøûÔºÅ",
                    hasPrize: true
                },
                { 
                    id: 3,
                    name: "0.2ÂÖÉÁ∫¢ÂåÖ", 
                    value: 0.20, 
                    weight: 3,
                    color: "#2196F3", 
                    message: "ÊÅ≠ÂñúËé∑Âæó0.2ÂÖÉÁ∫¢ÂåÖÔºÅÁ¶èÊ∞îÊª°Êª°ÔºÅ",
                    hasPrize: true
                },
                { 
                    id: 4,
                    name: "0.1ÂÖÉÁ∫¢ÂåÖ", 
                    value: 0.10, 
                    weight: 4,
                    color: "#9C27B0", 
                    message: "ÊÅ≠ÂñúËé∑Âæó0.1ÂÖÉÁ∫¢ÂåÖÔºÅÂêâÁ••Â¶ÇÊÑèÔºÅ",
                    hasPrize: true
                },
                { 
                    id: 5,
                    name: "0.01ÂÖÉÁ∫¢ÂåÖ", 
                    value: 0.01, 
                    weight: 5,
                    color: "#FF9800", 
                    message: "ÊÅ≠ÂñúËé∑Âæó0.01ÂÖÉÁ∫¢ÂåÖÔºÅÁßØÂ∞ëÊàêÂ§öÔºÅ",
                    hasPrize: true
                },
                { 
                    id: 6,
                    name: "Êñ∞Âπ¥Á•ùÁ¶è", 
                    value: 0.00, 
                    weight: 85,  // ÊùÉÈáçÊúÄÈ´ò
                    color: "#F44336", 
                    message: "ÊÅ≠ÂñúËé∑ÂæóÊñ∞Âπ¥Á•ùÁ¶èÔºÅ‰∏á‰∫ãÂ¶ÇÊÑèÔºÅ",
                    hasPrize: false
                }
            ];
            
            // DOMÂÖÉÁ¥†
            const blocksContainer = document.getElementById('blocksContainer');
            const startButton = document.getElementById('startButton');
            const statusMessage = document.getElementById('statusMessage');
            const resultModal = document.getElementById('resultModal');
            const resultTitle = document.getElementById('resultTitle');
            const resultAmount = document.getElementById('resultAmount');
            const resultMessage = document.getElementById('resultMessage');
            const qrCodeContainer = document.getElementById('qrCodeContainer');
            const qrCodeImage = document.getElementById('qrCodeImage');
            const qrCodeText = document.getElementById('qrCodeText');
            const playAgainBtn = document.getElementById('playAgainBtn');
            const closeModal = document.getElementById('closeModal');
            const balanceAmount = document.getElementById('balanceAmount');
            
            // Ê∏∏ÊàèÁä∂ÊÄÅ
            let totalBalance = 10.00;
            let isSpinning = false;
            let currentBlockIndex = 0;
            let blocks = [];
            let todayDrawn = false;
            
            // Ê£ÄÊü•‰ªäÂ§©ÊòØÂê¶Â∑≤ÁªèÊäΩËøáÂ•ñ
            function checkDailyDraw() {
                try {
                    const today = new Date().toDateString();
                    const lastDrawDate = localStorage.getItem('newYearLotteryLastDrawDate');
                    
                    if (lastDrawDate === today) {
                        // ‰ªäÂ§©Â∑≤ÁªèÊäΩËøáÂ•ñ
                        todayDrawn = true;
                        startButton.disabled = true;
                        startButton.textContent = "‰ªäÊó•Â∑≤ÊäΩÂ•ñ";
                        statusMessage.textContent = "‰ªäÊó•Â∑≤ÊäΩÂ•ñÔºåËØ∑ÊòéÂ§©ÂÜçÊù•ÔºÅ";
                        statusMessage.className = "status unavailable";
                    } else {
                        // ‰ªäÂ§©ËøòÊ≤°ÊäΩËøáÂ•ñ
                        todayDrawn = false;
                        startButton.disabled = false;
                        startButton.textContent = "ÂºÄÂßãÊäΩÂ•ñ";
                        statusMessage.textContent = "‰ªäÊó•ÂèØÊäΩÂ•ñÔºåÁÇπÂáªÂºÄÂßãÊåâÈíÆÔºÅ";
                        statusMessage.className = "status available";
                    }
                } catch (e) {
                    console.error("Ê£ÄÊü•ÊäΩÂ•ñÁä∂ÊÄÅÂ§±Ë¥•:", e);
                    todayDrawn = false;
                    startButton.disabled = false;
                    statusMessage.textContent = "ÁÇπÂáªÂºÄÂßãÊåâÈíÆÊäΩÂ•ñ";
                    statusMessage.className = "status available";
                }
            }
            
            // ËÆ∞ÂΩï‰ªäÊó•ÊäΩÂ•ñ
            function recordDailyDraw() {
                try {
                    const today = new Date().toDateString();
                    localStorage.setItem('newYearLotteryLastDrawDate', today);
                    todayDrawn = true;
                    startButton.disabled = true;
                    startButton.textContent = "‰ªäÊó•Â∑≤ÊäΩÂ•ñ";
                    statusMessage.textContent = "‰ªäÊó•Â∑≤ÊäΩÂ•ñÔºåËØ∑ÊòéÂ§©ÂÜçÊù•ÔºÅ";
                    statusMessage.className = "status unavailable";
                } catch (e) {
                    console.error("ËÆ∞ÂΩïÊäΩÂ•ñÁä∂ÊÄÅÂ§±Ë¥•:", e);
                }
            }
            
            // ÂàùÂßãÂåñÊñπÂùó
            function initBlocks() {
                blocksContainer.innerHTML = '';
                blocks = [];
                
                prizes.forEach((prize, index) => {
                    const block = document.createElement('div');
                    block.className = 'block';
                    block.dataset.index = index;
                    block.dataset.id = prize.id;
                    
                    // ËÆæÁΩÆÊñπÂùóËÉåÊôØËâ≤
                    block.style.backgroundColor = prize.color;
                    
                    // Ê∑ªÂä†ÊñπÂùóÂÜÖÂÆπ
                    block.innerHTML = `
                        <div class="block-value">${prize.value > 0 ? prize.value.toFixed(2) + 'ÂÖÉ' : 'Á•ùÁ¶è'}</div>
                        <div class="block-name">${prize.name}</div>
                    `;
                    
                    blocksContainer.appendChild(block);
                    blocks.push(block);
                });
                
                // ÂàùÂßãÂåñÁ¨¨‰∏Ä‰∏™ÊñπÂùó‰∏∫ÈÄâ‰∏≠Áä∂ÊÄÅ
                updateActiveBlock(0);
            }
            
            // Êõ¥Êñ∞ÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñπÂùóÔºàÈÄöËøáËÉåÊôØÈ¢úËâ≤Ôºâ
            function updateActiveBlock(index) {
                // ÁßªÈô§ÊâÄÊúâÊñπÂùóÁöÑactiveÁ±ª
                blocks.forEach(block => {
                    block.classList.remove('active');
                });
                
                // ‰∏∫ÂΩìÂâçÊñπÂùóÊ∑ªÂä†activeÁ±ª
                if (blocks[index]) {
                    blocks[index].classList.add('active');
                    currentBlockIndex = index;
                }
            }
            
            // ÂºÄÂßãÊäΩÂ•ñÂä®Áîª
            function startSpinAnimation() {
                if (isSpinning || todayDrawn) {
                    return;
                }
                
                isSpinning = true;
                startButton.disabled = true;
                resultModal.style.display = 'none';
                
                // ÈöèÊú∫ÈÄâÊã©Â•ñÈ°πÔºàÊ†πÊçÆÊùÉÈáçÔºâ
                const selectedPrize = selectPrizeByWeight();
                const targetIndex = prizes.findIndex(p => p.id === selectedPrize.id);
                
                // Âä®ÁîªÂèÇÊï∞
                const baseMoves = 20;
                const weightFactor = 85 - selectedPrize.weight;
                const totalMoves = baseMoves + weightFactor;
                
                let currentMove = 0;
                const initialSpeed = 100;
                let speedIncrease = 0;
                
                // ÂºÄÂßãÁßªÂä®Âä®Áîª
                function moveToNextBlock() {
                    let nextIndex = (currentBlockIndex + 1) % blocks.length;
                    updateActiveBlock(nextIndex);
                    
                    currentMove++;
                    speedIncrease++;
                    
                    // ÈÄêÊ∏êÂáèÈÄü
                    const currentSpeed = Math.max(50, initialSpeed + speedIncrease * 10);
                    
                    if (currentMove < totalMoves) {
                        // ÁªßÁª≠ÁßªÂä®
                        setTimeout(moveToNextBlock, currentSpeed);
                    } else {
                        // ÊúÄÂêéÂø´ÈÄüÁªèËøáÊâÄÊúâÊñπÂùóÂá†Ê¨°
                        let finalPasses = 3;
                        let passCount = 0;
                        
                        function finalPass() {
                            let nextIndex = (currentBlockIndex + 1) % blocks.length;
                            updateActiveBlock(nextIndex);
                            
                            passCount++;
                            if (passCount < finalPasses * blocks.length) {
                                setTimeout(finalPass, 50);
                            } else {
                                // ÊúÄÁªàÂÅúÂú®ÁõÆÊ†áÊñπÂùó
                                updateActiveBlock(targetIndex);
                                
                                // Áü≠ÊöÇÂª∂ËøüÂêéÂÆåÊàêÊäΩÂ•ñ
                                setTimeout(() => {
                                    finishSpin(targetIndex);
                                }, 500);
                            }
                        }
                        
                        setTimeout(finalPass, 50);
                    }
                }
                
                // ÂºÄÂßãÁßªÂä®
                moveToNextBlock();
            }
            
            // Ê†πÊçÆÊùÉÈáçÈÄâÊã©Â•ñÈ°π
            function selectPrizeByWeight() {
                // ÂàõÂª∫ÊùÉÈáçÊï∞ÁªÑ
                const weightArray = [];
                prizes.forEach(prize => {
                    for (let i = 0; i < prize.weight; i++) {
                        weightArray.push(prize);
                    }
                });
                
                // ÈöèÊú∫ÈÄâÊã©
                const randomIndex = Math.floor(Math.random() * weightArray.length);
                return weightArray[randomIndex];
            }
            
            // ÂÆåÊàêÊäΩÂ•ñ
            function finishSpin(prizeIndex) {
                const prize = prizes[prizeIndex];
                
                // ËÆ∞ÂΩï‰ªäÊó•ÊäΩÂ•ñ
                recordDailyDraw();
                
                // Êõ¥Êñ∞‰ΩôÈ¢ù
                if (prize.hasPrize) {
                    totalBalance -= prize.value;
                    if (totalBalance < 0) totalBalance = 0;
                }
                balanceAmount.textContent = totalBalance.toFixed(2);
                
                // ÊòæÁ§∫ÁªìÊûúÂºπÁ™ó
                showResultModal(prize);
                
                isSpinning = false;
            }
            
            // ÊòæÁ§∫ÁªìÊûúÂºπÁ™ó
            function showResultModal(prize) {
                resultTitle.textContent = prize.hasPrize ? "ÊÅ≠ÂñúÊÇ®‰∏≠Â•ñ‰∫ÜÔºÅ" : "Êñ∞Âπ¥Á•ùÁ¶èÔºÅ";
                resultAmount.textContent = prize.hasPrize ? prize.value.toFixed(2) + " ÂÖÉ" : "Á¶èÊ∞îÊª°Êª°";
                resultMessage.textContent = prize.message;
                
                // ËÆæÁΩÆ‰∫åÁª¥Á†Å
                if (prize.hasPrize) {
                    qrCodeContainer.style.display = 'inline-block';
                    qrCodeImage.innerHTML = '';
                    qrCodeText.textContent = "Êâ´Á†ÅÈ¢ÜÂèñÁ∫¢ÂåÖ";
                } else {
                    qrCodeContainer.style.display = 'none';
                }
                
                resultModal.style.display = 'flex';
            }
            
            // È°µÈù¢Á¶ªÂºÄÊèêÁ§∫
            function setupPageLeaveWarning() {
                window.addEventListener('beforeunload', function(e) {
                    e.preventDefault();
                    e.returnValue = 'ÊòéÂ§©‰∏ÄÂÆöË¶ÅÂÜçÂõûÊù•ÂïäÔºÅ';
                    return 'ÊòéÂ§©‰∏ÄÂÆöË¶ÅÂÜçÂõûÊù•ÂïäÔºÅ';
                });
            }
            
            // ‰∫ã‰ª∂ÁõëÂê¨
            startButton.addEventListener('click', startSpinAnimation);
            
            playAgainBtn.addEventListener('click', function() {
                resultModal.style.display = 'none';
            });
            
            closeModal.addEventListener('click', function() {
                resultModal.style.display = 'none';
            });
            
            // ÁÇπÂáªÂºπÁ™óÂ§ñÈÉ®ÂÖ≥Èó≠ÂºπÁ™ó
            resultModal.addEventListener('click', function(e) {
                if (e.target === resultModal) {
                    resultModal.style.display = 'none';
                }
            });
            
            // ÂàùÂßãÂåñ‰∫åÁª¥Á†ÅÂõæÁâá
            qrCodeImage.innerHTML = '';
            
            // ÂàùÂßãÂåñÊ∏∏Êàè
            function initGame() {
                initBlocks();
                checkDailyDraw();
                setupPageLeaveWarning();
            }
            
            // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñÊ∏∏Êàè
            initGame();
        });
    </script>
</body>
</html>
